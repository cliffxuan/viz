{"version":3,"sources":["TreeSpec.ts","tokenizer.ts","parser.ts","App.tsx","serviceWorker.ts","index.tsx"],"names":["spec","$schema","description","width","height","padding","signals","data","name","transform","type","key","parentKey","method","size","signal","separation","as","source","orient","shape","scales","range","scheme","domain","field","zero","marks","from","encode","update","path","stroke","value","enter","x","y","fill","scale","text","fontSize","baseline","dx","align","Arrow","start","end","this","splitWith","str","sep","parts","split","positions","part","last","length","search","push","zip","map","trim","tokenize","graph","arrows","chain","index","filter","p","startCol","rowNum","nodes","slice","prev","prevPos","next","nextPos","arrow","endCol","startRow","endRow","extractPairs","fromPairs","flatten","Vertex","id","predecessors","successors","cache","isAcyclic","Infinity","undefined","cachedValue","result","apply","Math","min","v","depth","vertex","visited","successor","includes","successorPath","pathTo","concat","isDescendant","descendants","DirectedGraph","vertices","isTree","isMultiTree","treeArrows","restArrows","newGraph","fromArrows","pop","e","max","roots","nameToVertex","predecessorName","successorName","predecessorId","successorId","predecessor","Object","values","Tree","root","parent","parse","arrowToPos","arrowsWithPos","arrowToPositions","ps","toString","groupByArrow","useStyles","makeStyles","theme","createStyles","display","flexDirection","appBar","backgroundColor","color","saveButton","marginLeft","spacing","toolbarRightDiv","toggleButton","position","top","right","main","flexGrow","overflow","pane","paper","palette","secondary","center","margin","firebase","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","firestore","App","render","match","GraphContainer","docId","params","makeid","characters","charactersLength","i","charAt","floor","random","useState","setData","redirect","setRedirect","useEffect","a","collection","doc","get","exists","replace","fetchDoc","to","Graph","handleChange","handleSave","set","MultiTree","multiTree","tree","fromRoot","breadth","E","Vega","treeSpec","editorRef","useRef","classes","isEditorReady","setIsEditorReady","isOnePane","setIsOnePane","directedGraph","pairToPositions","findTree","rest","errors","startLineNumber","startColumn","endLineNumber","endColumn","message","useLayoutEffect","monaco","init","then","monacoInstance","current","editor","setModelMarkers","getModel","error","severity","MarkerSeverity","Error","className","AppBar","elevation","Toolbar","Typography","variant","Button","IconButton","href","target","rel","Grid","container","item","xs","md","style","Paper","square","onClick","language","editorDidMount","_","onChange","options","minimap","enabled","scrollBeyondLastLine","Boolean","window","location","hostname","ReactDOM","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","console"],"mappings":"8cAoGeA,G,OAlGI,CACjBC,QAAS,6CACTC,YACE,gFACFC,MAAO,IACPC,OAAQ,KACRC,QAAS,EAETC,QAAS,GAETC,KAAM,CACJ,CACEC,KAAM,OACNC,UAAW,CACT,CACEC,KAAM,WACNC,IAAK,KACLC,UAAW,UAEb,CACEF,KAAM,OACNG,OAAQ,OACRC,KAAM,CAAC,CAAEC,OAAQ,UAAY,CAAEA,OAAQ,gBACvCC,YAAY,EACZC,GAAI,CAAC,IAAK,IAAK,QAAS,eAI9B,CACET,KAAM,QACNU,OAAQ,OACRT,UAAW,CACT,CAAEC,KAAM,aACR,CACEA,KAAM,WACNS,OAAQ,aACRC,MAAO,eAMfC,OAAQ,CACN,CACEb,KAAM,QACNE,KAAM,SACNY,MAAO,CAAEC,OAAQ,SACjBC,OAAQ,CAAEjB,KAAM,OAAQkB,MAAO,SAC/BC,MAAM,IAIVC,MAAO,CACL,CACEjB,KAAM,OACNkB,KAAM,CAAErB,KAAM,SACdsB,OAAQ,CACNC,OAAQ,CACNC,KAAM,CAAEN,MAAO,QACfO,OAAQ,CAAEC,MAAO,WAIvB,CACEvB,KAAM,SACNkB,KAAM,CAAErB,KAAM,QACdsB,OAAQ,CACNK,MAAO,CACLpB,KAAM,CAAEmB,MAAO,KACfD,OAAQ,CAAEC,MAAO,SAEnBH,OAAQ,CACNK,EAAG,CAAEV,MAAO,KACZW,EAAG,CAAEX,MAAO,KACZY,KAAM,CAAEC,MAAO,QAASb,MAAO,YAIrC,CACEf,KAAM,OACNkB,KAAM,CAAErB,KAAM,QACdsB,OAAQ,CACNK,MAAO,CACLK,KAAM,CAAEd,MAAO,QACfe,SAAU,CAAEP,MAAO,GACnBQ,SAAU,CAAER,MAAO,WAErBH,OAAQ,CACNK,EAAG,CAAEV,MAAO,KACZW,EAAG,CAAEX,MAAO,KACZiB,GAAI,CAAE3B,OAAQ,2BACd4B,MAAO,CAAE5B,OAAQ,2C,yDC3Fd6B,EAAb,WACE,WAAmBC,EAAsBC,GAAc,yBAApCD,QAAmC,KAAbC,MAD3C,uDAII,MAAM,GAAN,OAAUC,KAAKF,MAAf,eAA2BE,KAAKD,OAJpC,+BAQI,MAAO,CAACC,KAAKF,MAAOE,KAAKD,SAR7B,KAoBO,SAASE,EAAUC,EAAaC,GACrC,IAD2E,EACrEC,EAAQF,EAAIG,MAAMF,GAClBG,EAAY,CAAC,GAFwD,cAG1DF,GAH0D,IAG3E,2BAAwB,CAAC,IAAhBG,EAAe,QAChBC,EAAOF,EAAUA,EAAUG,OAAS,GAC1CH,EAAUA,EAAUG,OAAS,GAAKD,EAAOD,EAAKG,OAAO,MACrDJ,EAAUK,KAAKH,EAAOD,EAAKE,OAASN,EAAIM,SANiC,8BAQ3E,OAAOG,YACLR,EAAMS,KAAI,SAACN,GAAD,OAAUA,EAAKO,UACzBR,GAqBG,SAASS,EAASC,GACvB,IAAMC,EAASD,EAAMX,MAAM,MAAMQ,KAAI,SAACK,EAAOC,GAAR,OACnClB,EAAUiB,EAAO,KACdE,QAAO,mCAAEC,EAAF,gBAAyB,KAAbA,EAAEP,UACrBD,KAAI,0CArBJ,SACLK,EACAI,EACAC,GAEA,IAAMC,EAAQvB,EAAUiB,EAAO,MAC/B,OAAON,YAAIY,EAAOA,EAAMC,MAAM,IAAIZ,KAChC,yDAAGa,EAAH,KAASC,EAAT,2BAAoBC,EAApB,KAA0BC,EAA1B,WAAyC,CACvCC,MAAO,IAAIjC,EAAM6B,EAAME,GACvBN,SAAUA,EAAWK,EAAU,EAC/BI,OAAQT,EAAWO,EAAUD,EAAKnB,OAAS,EAC3CuB,SAAUT,EACVU,OAAQV,MASoBW,CAAvB,UAAqDf,EAAQ,SAEtE,OAAOgB,YAAUC,YAAQnB,GAAQJ,KAAI,SAACiB,EAAOX,GAAR,MAAkB,CAACA,EAAOW,OCxD1D,IAAMO,EAAb,WAME,WACEC,EACA7E,EACA8E,EACAC,GACC,yBAVHF,QAUE,OATF7E,UASE,OARF8E,kBAQE,OAPFC,gBAOE,EACAxC,KAAKsC,GAAKA,EACVtC,KAAKvC,KAAOA,EACZuC,KAAKuC,aAAL,OAAoBA,QAApB,IAAoBA,IAAiB,GACrCvC,KAAKwC,WAAL,OAAkBA,QAAlB,IAAkBA,IAAe,GAfrC,kDAkBQC,GACJ,IAAKzC,KAAK0C,UACR,OAAOC,IAET,QAAcC,IAAVH,EAAqB,CACvB,IAAMI,EAAcJ,EAAMzC,KAAKsC,IAC/B,QAAoBM,IAAhBC,EACF,OAAOA,EAIX,IAAMC,EACJ9C,KAAKuC,aAAa9B,OAAS,EACvBsC,YACEC,KAAKC,IACLjD,KAAKuC,aAAa1B,KAAI,SAACqC,GAAD,OAAOA,EAAEC,MAAMV,OACnC,EACJ,EAIN,YAHcG,IAAVH,IACFA,EAAMzC,KAAKsC,IAAMQ,GAEZA,IAvCX,6BA0CSM,EAAgBC,GAIrB,QAHgBT,IAAZS,IACFA,EAAU,IAEmB,IAA3BrD,KAAKwC,WAAW/B,OAClB,OAAO,KAL2D,oBAO9CT,KAAKwC,YAPyC,IAOpE,2BAAuC,CAAC,IAA/Bc,EAA8B,QACrC,GAAIA,IAAcF,EAChB,MAAO,CAACpD,KAAMsD,GAEhB,GAAID,EAAQE,SAASD,GACnB,OAAO,KAETD,EAAQ1C,KAAK2C,GACb,IAAME,EAAgBF,EAAUG,OAAOL,EAAQC,GAC/C,GAAsB,OAAlBG,EAGF,MAAO,CAACxD,MAAgB0D,OAAOF,IAnBiC,8BAsBpE,OAAO,OAhEX,mCAmEeJ,GAA0B,IAAD,OACpC,OAAIA,IAAWpD,MAIboD,EAAOZ,WAAWpB,QAAO,SAACkC,GAAD,OAAe,EAAKK,aAAaL,MACvD7C,OAAS,IAzElB,kCAkFI,OAAOT,KAAKwC,WAAWkB,OACrBtB,YAAQpC,KAAKwC,WAAW3B,KAAI,SAACyC,GAAD,OAAeA,EAAUM,mBAnF3D,gCAwFI,GAA0B,OAAtB5D,KAAKyD,OAAOzD,MACd,OAAO,EAFc,oBAIDA,KAAKwC,YAJJ,IAIvB,2BAAuC,CACrC,IADqC,QACtBE,UACb,OAAO,GANY,8BASvB,OAAO,MAhGX,KAoGamB,EAAb,WAGE,WAAYC,GAA0B,yBAFtCA,cAEqC,EACnC9D,KAAK8D,SAAWA,EAJpB,uDAwEI,GAAI9D,KAAK+D,QAAU/D,KAAKgE,YACtB,MAAO,CAAChE,KAAM,IAEhB,IAJwC,EAIlCiE,EAAa,GACbC,EAAa,GACflD,EAAQ,IAAI6C,EAAc,IANU,cAOtB7D,KAAKiB,QAPiB,IAOxC,2BAA+B,CAAC,IAAvBa,EAAsB,QAC7BmC,EAAWtD,KAAKmB,GAChB,IAAIqC,EAAWN,EAAcO,WAAWH,GAClCE,EAASH,aAAeG,EAASJ,OAIrC/C,EAAQmD,GAHRF,EAAWI,MACXH,EAAWvD,KAAKmB,KAZoB,8BAiBxC,MAAO,CAACd,EAAOkD,KAxFnB,6BAQI,OAAO9B,YACLpC,KAAK8D,SAASjD,KAAI,SAACqC,GAAD,OAAOA,EAAEV,WAAW3B,KAAI,SAACyD,GAAD,OAAO,IAAIzE,EAAMqD,EAAEzF,KAAM6G,EAAE7G,eAT3E,4BAcI,IAAKuC,KAAK0C,UACR,OAAOC,IAET,IAAMF,EAAQ,GACd,OAAOM,YACLC,KAAKuB,IACLvE,KAAK8D,SAASjD,KAAI,SAACqC,GAAD,OAAOA,EAAEC,MAAMV,SApBvC,8BAyBI,OAAOzC,KAAK8D,SAAS1C,QAAO,SAAC8B,GAAD,OAA+B,IAAxBA,EAAEV,WAAW/B,UAAcA,SAzBlE,4BA6BI,OAAOT,KAAK8D,SAAS1C,QAAO,SAAC8B,GAAD,OAAiC,IAA1BA,EAAEX,aAAa9B,YA7BtD,6BAiCI,OAA0B,IAAtBT,KAAKwE,MAAM/D,WAGXT,KAAK8D,SAAS1C,QAAO,SAAC8B,GAAD,OAAOA,EAAEX,aAAa9B,OAAS,KAAGA,OAAS,MAGhET,KAAK8D,SAAS1C,QAAO,SAAC8B,GAAD,OAAOA,EAAEX,aAAagB,SAASL,MAAIzC,OAAS,MAvCzE,kCA8CI,QAAIT,KAAKwE,MAAM/D,OAAS,OAGpBT,KAAK8D,SAAS1C,QAAO,SAAC8B,GAAD,OAAOA,EAAEX,aAAa9B,OAAS,KAAGA,OAAS,MAGhET,KAAK8D,SAAS1C,QAAO,SAAC8B,GAAD,OAAOA,EAAEX,aAAagB,SAASL,MAAIzC,OAAS,MApDzE,gCA2DI,OAA6B,IAAzBT,KAAK8D,SAASrD,QAGQ,IAAtBT,KAAKwE,MAAM/D,SAGW,IAAtBT,KAAKwE,MAAM/D,QACNT,KAAKwE,MAAM,GAAG9B,cAlE3B,kCA2FoBzB,GAChB,IADqD,EAC/CwD,EAAuC,GACzCnC,GAAM,EAF2C,cAGjCrB,GAHiC,IAGrD,2BAA4B,CAAC,IAAD,IAAjBa,EAAiB,QACpB4C,EAAkB5C,EAAMhC,MACxB6E,EAAgB7C,EAAM/B,IACxB6E,EAAa,UAAGH,EAAaC,UAAhB,aAAG,EAA+BpC,GAC/CuC,EAAW,UAAGJ,EAAaE,UAAhB,aAAG,EAA6BrC,QAEzBM,IAAlBgC,IACFA,IAAkBtC,EAClBmC,EAAaC,GAAmB,IAAIrC,EAClCuC,EACAF,SAGgB9B,IAAhBiC,IACFA,IAAgBvC,EAChBmC,EAAaE,GAAiB,IAAItC,EAAOwC,EAAaF,IAExD,IAAMrB,EAAYmB,EAAaE,GACzBG,EAAcL,EAAaC,GACjCpB,EAAUf,aAAa5B,KAAKmE,GAC5BA,EAAYtC,WAAW7B,KAAK2C,IAvBuB,8BAyBrD,OAAO,IAAIO,EAAckB,OAAOC,OAAOP,QApH3C,KAwHaQ,EAAb,WACE,WAAmBnB,GAA0B,yBAA1BA,WADrB,iDAQI,OAAO9D,KAAK8D,SAAS1C,QAAO,SAAC8B,GAAD,OAAiC,IAA1BA,EAAEX,aAAa9B,UAAc,KARpE,2BAW0E,IAAD,OACrE,OAAOT,KAAK8D,SACT1C,QAAO,SAAC8B,GAAD,OAAOA,EAAES,aAAa,EAAKuB,SAClCrE,KAAI,SAACqC,GAAD,YAAgB,CACnBZ,GAAIY,EAAEZ,GACN7E,KAAMyF,EAAEzF,KACR0H,OAAM,UAAEjC,EAAEX,aAAa,UAAjB,aAAE,EAAmBD,SAjBnC,4BAsBI,IAAMG,EAAQ,GACd,OAAOM,YACLC,KAAKuB,IACLvE,KAAK8D,SAASjD,KAAI,SAACqC,GAAD,OAAOA,EAAEC,MAAMV,SAzBvC,8BA8BI,OAAOzC,KAAK8D,SAAS1C,QAAO,SAAC8B,GAAD,OAA+B,IAAxBA,EAAEV,WAAW/B,UAAcA,UA9BlE,gCAGkByE,GACd,OAAO,IAAID,EAAK,CAACC,GAAMxB,OAAOwB,EAAKtB,kBAJvC,KAkCO,SAASwB,EAAMpE,GACpB,IAAMqE,EDpMD,SACLC,GAGA,IADA,IAAMC,EAA6D,GACnE,MAAeR,OAAOC,OAAOM,GAA7B,eAA6C,CAAxC,IAAIE,EAAE,KAEH5H,EADY4H,EAAV1D,MACU2D,gBACY7C,IAA1B2C,EAAiB3H,KACnB2H,EAAiB3H,GAAO,IAE1B2H,EAAiB3H,GAAK+C,KAAK6E,GAE7B,OAAOD,ECwLiDG,CAAa3E,EAASC,IACxEC,EAAS8D,OAAOC,OAAOK,GAAYxE,KAAI,SAACQ,GAAD,OAAOA,EAAE,GAAGS,SACzD,MAAO,CAAC+B,EAAcO,WAAWnD,GAASoE,GCnO5C,IAAMM,EAAYC,aAAW,SAACC,GAC5B,OAAOC,YAAa,CAClBZ,KAAM,CACJ7H,OAAQ,qBACR0I,QAAS,OACTC,cAAe,UAEjBC,OAAQ,CACNC,gBAAiB,OACjBC,MAAO,QAETC,WAAY,CACVC,WAAYR,EAAMS,QAAQ,IAE5BC,gBAAiB,CACfF,WAAY,QAEdG,aAAc,CACZC,SAAU,WACVC,IAAK,MACLC,MAAO,OAETC,KAAM,CACJC,SAAU,EACVb,cAAe,cACfc,SAAU,OACVxJ,QAASuI,EAAMS,QAAQ,IAEzBS,KAAM,CACJ1J,OAAQ,QAEV2J,MAAO,CACLb,MAAON,EAAMoB,QAAQzH,KAAK0H,UAC1B7J,OAAQ,OACRyJ,SAAU,QAEZK,OAAQ,CACN/J,MAAO,MACPgK,OAAQ,aAMdC,IAASC,cAAc,CACrBC,OAAQ,0CACRC,WAAY,kCACZC,YAAa,yCACbC,UAAW,kBACXC,cAAe,8BACfC,kBAAmB,eACnBC,MAAO,4CACPC,cAAe,iBAEjB,IAAMC,EAAYV,IAASU,YAEZ,SAASC,IACtB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CACEhJ,KAAK,UACLiJ,OAAQ,gBAAGC,EAAH,EAAGA,MAAH,OAAe,kBAACC,GAAD,CAAgBC,MAAOF,EAAMG,OAAOD,WAE7D,kBAAC,IAAD,CAAOpJ,KAAK,IAAIiJ,OAAQ,kBAAM,kBAACE,GAAD,CAAgBC,MAAM,iBAU5D,SAASE,EAAO7H,GAKd,IAJA,IAAIqC,EAAS,GACTyF,EACF,iEACEC,EAAmBD,EAAW9H,OACzBgI,EAAI,EAAGA,EAAIhI,EAAQgI,IAC1B3F,GAAUyF,EAAWG,OAAO1F,KAAK2F,MAAM3F,KAAK4F,SAAWJ,IAEzD,OAAO1F,EAGT,SAASqF,GAAT,GAAyD,IAA/BC,EAA8B,EAA9BA,MAA8B,EAC9BS,mBAAS,IADqB,mBAC/CrL,EAD+C,KACzCsL,EADyC,OAEtBD,mBAAwB,MAFF,mBAE/CE,EAF+C,KAErCC,EAFqC,KAkBtD,OAdAC,qBAAU,YACM,uCAAG,gCAAAC,EAAA,sEACGnB,EAAUoB,WAAW,UAAUC,IAAIhB,GAAOiB,MAD7C,OACTD,EADS,OAET5L,EAFS,UAEF4L,EAAI5L,cAFF,aAEF,EAAYwD,MACpBoI,EAAIE,QAAmB,OAAT9L,GAGjBwL,EAAY,MACZF,EAAQtL,EAAK+L,QAAQ,QAAS,QAH9BP,EAAY,IAJC,2CAAH,qDAUdQ,KACC,CAACpB,IAEa,OAAbW,EACK,kBAAC,IAAD,CAAUU,GAAIV,IAGrB,kBAACW,GAAD,CACElM,KAAMA,EACNmM,aAAcb,EACdc,WAAU,uCAAE,WAAOpM,GAAP,eAAA0L,EAAA,6DACJ5G,EAAKgG,EAAO,GADR,SAEJP,EAAUoB,WAAW,UAAUC,IAAI9G,GAAIuH,IAAI,CAAE7I,MAAOxD,IAFhD,OAGVwL,EAAY1G,GAHF,2CAAF,wDAehB,SAASwH,GAAT,GAAiE,IAA5CC,EAA2C,EAA3CA,UACnB,OACE,oCACGA,EAAUvF,MAAM3D,KAAI,SAACqE,EAAM/D,GAC1B,IAAM6I,EAAO/E,EAAKgF,SAAS/E,GACrB/B,EAAQ6G,EAAK7G,MACb/F,EAAQ+F,IAAUR,IAAW,IAAM,IAAMQ,EACzC+G,EAAUF,EAAKE,QAEf7M,EAAS6M,GADD,YAAKlH,KAAKmH,GAAOD,EAAU,IAAM,GAE/C,OACE,kBAACE,EAAA,EAAD,CACExM,IAAKuD,EACLlE,KAAI,eAAOoN,EAAP,CAAiBjN,QAAOC,WAC5BG,KAAM,CAAEwM,KAAMA,EAAKxM,YAY/B,SAASkM,GAAT,GAAgE,IAA/ClM,EAA8C,EAA9CA,KAAMmM,EAAwC,EAAxCA,aACfW,GADuD,EAA1BV,WACjBW,iBAAyB,OACrCC,EAAU7E,IAF6C,EAGnBkD,oBAAS,GAHU,mBAGtD4B,EAHsD,KAGvCC,EAHuC,OAI3B7B,oBAAS,GAJkB,mBAItD8B,EAJsD,KAI3CC,EAJ2C,OAKpBxF,EAAM5H,GALc,mBAKtDqN,EALsD,KAKvCC,EALuC,OAMxCD,EAAcE,WAN0B,mBAMtDf,EANsD,KAMhDgB,EANgD,KAOvDC,EAAS7I,YACb4I,EAAKnK,KAAI,SAACiB,GAAD,OAAWgJ,EAAgBhJ,EAAM2D,gBAC1C5E,KAAI,kBAA6C,CACjDqK,gBADI,EAAGlJ,SAEPmJ,YAFI,EAAa7J,SAGjB8J,cAHI,EAAuBnJ,OAI3BoJ,UAJI,EAA+BtJ,OAKnCuJ,QAAS,4DAGXC,2BAAgB,WACdC,SAAOC,OAAOC,MAAK,SAACC,GACdlB,GAAuC,OAAtBH,EAAUsB,SAC7BD,EAAeE,OAAOC,gBACpBxB,EAAUsB,QAAQG,WAClB,QACAd,EAAOpK,KAAI,SAACmL,GAAD,sBACNA,EADM,CAETC,SAAUN,EAAeO,eAAeC,kBAYlD,OACE,yBAAKC,UAAW5B,EAAQtF,MACtB,kBAACmH,EAAA,EAAD,CAAQ5F,SAAS,SAAS2F,UAAW5B,EAAQvE,OAAQqG,UAAW,GAC9D,kBAACC,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,CAAYC,QAAQ,MAApB,+BACA,kBAACC,EAAA,EAAD,CAAQN,UAAW5B,EAAQpE,YACzB,kBAAC,IAAD,MADF,QAIA,yBAAKgG,UAAW5B,EAAQjE,iBACtB,kBAACoG,EAAA,EAAD,CACEC,KAAK,mCACLC,OAAO,SACPC,IAAI,uBAEJ,kBAAC,IAAD,UAKR,kBAACC,EAAA,EAAD,CAAMC,WAAS,EAAC1G,QAAS,EAAG8F,UAAW5B,EAAQ5D,MAC7C,kBAACmG,EAAA,EAAD,CACEE,MAAI,EACJC,GAAI,GACJC,GAAIxC,EAAY,GAAK,EACrByB,UAAW5B,EAAQzD,KACnBqG,MAAO,CAAE3G,SAAU,aAEnB,kBAAC4G,EAAA,EAAD,CAAOZ,QAAQ,WAAWL,UAAW5B,EAAQxD,MAAOsG,QAAM,GACxD,yBAAKlB,UAAWzB,EAAYH,EAAQrD,OAAS,IAC3C,kBAAC2C,GAAD,CAAWC,UAAWC,MAG1B,kBAAC2C,EAAA,EAAD,CACEP,UAAW5B,EAAQhE,aACnBzI,KAAK,QACLwP,QAAS,kBAAM3C,GAAcD,KAE5BA,EAAY,kBAAC,IAAD,MAAyB,kBAAC,IAAD,QAGzCA,EAAY,KACX,kBAACoC,EAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GAAIC,GAAI,EAAGf,UAAW5B,EAAQzD,MAC3C,kBAACsG,EAAA,EAAD,CAAOZ,QAAQ,WAAWL,UAAW5B,EAAQxD,MAAOsG,QAAM,GACxD,kBAAC,mBAAD,CACEE,SAAS,aACTtO,MAAO1B,EACPJ,MAAM,OACNqQ,eArD+B,SAACC,EAAG7B,GAC/CnB,GAAiB,GACjBJ,EAAUsB,QAAUC,GAoDR8B,SAAU,SAACD,EAAGxO,GAAJ,YACE0D,IAAV1D,EAAsBA,EAAQyK,EAAazK,IAE7C0O,QAAS,CACPC,QAAS,CAAEC,SAAS,GACpBC,sBAAsB,SCvQpBC,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASjG,MACvB,2DCZNkG,IAASnG,OACP,kBAAC,IAAMoG,WAAP,KACE,kBAACrG,EAAD,OAEFsG,SAASC,eAAe,SDiIpB,kBAAmBC,WACrBA,UAAUC,cAAcC,MACrBhD,MAAK,SAAAiD,GACJA,EAAaC,gBAEdC,OAAM,SAAA7C,GACL8C,QAAQ9C,MAAMA,EAAMV,c","file":"static/js/main.1b08e652.chunk.js","sourcesContent":["import { Spec } from \"vega\";\n\nconst spec: Spec = {\n  $schema: \"https://vega.github.io/schema/vega/v5.json\",\n  description:\n    \"An example of Cartesian layouts for a node-link diagram of hierarchical data.\",\n  width: 600,\n  height: 1600,\n  padding: 5,\n\n  signals: [],\n\n  data: [\n    {\n      name: \"tree\",\n      transform: [\n        {\n          type: \"stratify\",\n          key: \"id\",\n          parentKey: \"parent\",\n        },\n        {\n          type: \"tree\",\n          method: \"tidy\",\n          size: [{ signal: \"height\" }, { signal: \"width - 100\" }],\n          separation: false,\n          as: [\"y\", \"x\", \"depth\", \"children\"],\n        },\n      ],\n    },\n    {\n      name: \"links\",\n      source: \"tree\",\n      transform: [\n        { type: \"treelinks\" },\n        {\n          type: \"linkpath\",\n          orient: \"horizontal\",\n          shape: \"diagonal\",\n        },\n      ],\n    },\n  ],\n\n  scales: [\n    {\n      name: \"color\",\n      type: \"linear\",\n      range: { scheme: \"magma\" },\n      domain: { data: \"tree\", field: \"depth\" },\n      zero: true,\n    },\n  ],\n\n  marks: [\n    {\n      type: \"path\",\n      from: { data: \"links\" },\n      encode: {\n        update: {\n          path: { field: \"path\" },\n          stroke: { value: \"#ccc\" },\n        },\n      },\n    },\n    {\n      type: \"symbol\",\n      from: { data: \"tree\" },\n      encode: {\n        enter: {\n          size: { value: 100 },\n          stroke: { value: \"#fff\" },\n        },\n        update: {\n          x: { field: \"x\" },\n          y: { field: \"y\" },\n          fill: { scale: \"color\", field: \"depth\" },\n        },\n      },\n    },\n    {\n      type: \"text\",\n      from: { data: \"tree\" },\n      encode: {\n        enter: {\n          text: { field: \"name\" },\n          fontSize: { value: 9 },\n          baseline: { value: \"middle\" },\n        },\n        update: {\n          x: { field: \"x\" },\n          y: { field: \"y\" },\n          dx: { signal: \"datum.children ? -7 : 7\" },\n          align: { signal: \"datum.children ? 'right' : 'left'\" },\n        },\n      },\n    },\n  ],\n};\n\nexport default spec;\n","import { flatten, zip, fromPairs } from \"ramda\";\n\nexport class Arrow {\n  constructor(public start: string, public end: string) {}\n\n  toString(): string {\n    return `${this.start} -> ${this.end}`;\n  }\n\n  toPair(): [string, string] {\n    return [this.start, this.end];\n  }\n}\n\nexport type ArrowWithPosition = {\n  arrow: Arrow;\n  startRow: number;\n  endRow: number;\n  startCol: number;\n  endCol: number;\n};\n\nexport function splitWith(str: string, sep: string): Array<[string, number]> {\n  const parts = str.split(sep);\n  const positions = [1];\n  for (let part of parts) {\n    const last = positions[positions.length - 1];\n    positions[positions.length - 1] = last + part.search(/\\S/);\n    positions.push(last + part.length + sep.length);\n  }\n  return zip(\n    parts.map((part) => part.trim()),\n    positions\n  );\n}\n\nexport function extractPairs(\n  chain: string,\n  startCol: number,\n  rowNum: number\n): Array<ArrowWithPosition> {\n  const nodes = splitWith(chain, \"->\");\n  return zip(nodes, nodes.slice(1)).map(\n    ([[prev, prevPos], [next, nextPos]]) => ({\n      arrow: new Arrow(prev, next),\n      startCol: startCol + prevPos - 1,\n      endCol: startCol + nextPos + next.length - 1,\n      startRow: rowNum,\n      endRow: rowNum,\n    })\n  );\n}\n\nexport function tokenize(graph: string): Record<number, ArrowWithPosition> {\n  const arrows = graph.split(\"\\n\").map((chain, index) =>\n    splitWith(chain, \";\")\n      .filter(([p, _]) => p.trim() !== \"\")\n      .map(([arrow, startCol]) => extractPairs(arrow, startCol, index + 1))\n  );\n  return fromPairs(flatten(arrows).map((arrow, index) => [index, arrow]));\n}\n\nexport function groupByArrow(\n  arrowsWithPos: Record<number, ArrowWithPosition>\n): Record<string, Array<ArrowWithPosition>> {\n  const arrowToPositions: Record<string, Array<ArrowWithPosition>> = {};\n  for (let ps of Object.values(arrowsWithPos)) {\n    const { arrow } = ps;\n    const key = arrow.toString()\n    if (arrowToPositions[key] === undefined) {\n      arrowToPositions[key] = [];\n    }\n    arrowToPositions[key].push(ps);\n  }\n  return arrowToPositions;\n}\n","import { apply, flatten } from \"ramda\";\nimport { tokenize, Arrow, ArrowWithPosition, groupByArrow } from \"./tokenizer\";\n\nexport class Vertex {\n  id: number;\n  name: string;\n  predecessors: Array<Vertex>;\n  successors: Array<Vertex>;\n\n  constructor(\n    id: number,\n    name: string,\n    predecessors?: Array<Vertex>,\n    successors?: Array<Vertex>\n  ) {\n    this.id = id;\n    this.name = name;\n    this.predecessors = predecessors ?? ([] as Vertex[]);\n    this.successors = successors ?? ([] as Vertex[]);\n  }\n\n  depth(cache?: Record<number, number>): number {\n    if (!this.isAcyclic) {\n      return Infinity;\n    }\n    if (cache !== undefined) {\n      const cachedValue = cache[this.id];\n      if (cachedValue !== undefined) {\n        return cachedValue;\n      }\n    }\n    // TODO cyclic\n    const result =\n      this.predecessors.length > 0\n        ? apply(\n            Math.min,\n            this.predecessors.map((v) => v.depth(cache))\n          ) + 1\n        : 1;\n    if (cache !== undefined) {\n      cache[this.id] = result;\n    }\n    return result;\n  }\n\n  pathTo(vertex: Vertex, visited?: Array<Vertex>): Array<Vertex> | null {\n    if (visited === undefined) {\n      visited = [] as Vertex[];\n    }\n    if (this.successors.length === 0) {\n      return null;\n    }\n    for (let successor of this.successors) {\n      if (successor === vertex) {\n        return [this, successor] as Vertex[];\n      }\n      if (visited.includes(successor)) {\n        return null;\n      }\n      visited.push(successor);\n      const successorPath = successor.pathTo(vertex, visited); // recursive\n      if (successorPath === null) {\n        continue;\n      } else {\n        return [this as Vertex].concat(successorPath);\n      }\n    }\n    return null;\n  }\n\n  isDescendant(vertex: Vertex): boolean {\n    if (vertex === this) {\n      return true;\n    }\n    if (\n      vertex.successors.filter((successor) => this.isDescendant(successor))\n        .length > 0\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  get descendants(): Array<Vertex> {\n    // TODO too much recursion\n    return this.successors.concat(\n      flatten(this.successors.map((successor) => successor.descendants))\n    );\n  }\n\n  get isAcyclic(): boolean {\n    if (this.pathTo(this) !== null) {\n      return false;\n    }\n    for (let successor of this.successors) {\n      if (!successor.isAcyclic) {\n        return false;\n      }\n    }\n    return true;\n  }\n}\n\nexport class DirectedGraph {\n  vertices: Array<Vertex>;\n\n  constructor(vertices: Array<Vertex>) {\n    this.vertices = vertices;\n  }\n\n  get arrows(): Array<Arrow> {\n    return flatten(\n      this.vertices.map((v) => v.successors.map((e) => new Arrow(v.name, e.name)))\n    );\n  }\n\n  get depth(): number {\n    if (!this.isAcyclic) {\n      return Infinity;\n    }\n    const cache = {};\n    return apply(\n      Math.max,\n      this.vertices.map((v) => v.depth(cache))\n    );\n  }\n\n  get breadth(): number {\n    return this.vertices.filter((v) => v.successors.length === 0).length;\n  }\n\n  get roots(): Array<Vertex> {\n    return this.vertices.filter((v) => v.predecessors.length === 0);\n  }\n\n  get isTree(): boolean {\n    if (this.roots.length !== 1) {\n      return false;\n    }\n    if (this.vertices.filter((v) => v.predecessors.length > 1).length > 0) {\n      return false;\n    }\n    if (this.vertices.filter((v) => v.predecessors.includes(v)).length > 0) {\n      return false;\n    }\n    return true;\n  }\n\n  get isMultiTree(): boolean {\n    if (this.roots.length < 2) {\n      return false;\n    }\n    if (this.vertices.filter((v) => v.predecessors.length > 1).length > 0) {\n      return false;\n    }\n    if (this.vertices.filter((v) => v.predecessors.includes(v)).length > 0) {\n      return false;\n    }\n    return true;\n  }\n\n  get isAcyclic(): boolean {\n    if (this.vertices.length === 0) {\n      return true;\n    }\n    if (this.roots.length === 0) {\n      return false;\n    }\n    if (this.roots.length === 1) {\n      return this.roots[0].isAcyclic;\n    }\n    return true;\n  }\n\n  findTree(): [DirectedGraph, Array<Arrow>] {\n    if (this.isTree || this.isMultiTree) {\n      return [this, []];\n    }\n    const treeArrows = [];\n    const restArrows = [];\n    let graph = new DirectedGraph([]);\n    for (let arrow of this.arrows) {\n      treeArrows.push(arrow);\n      let newGraph = DirectedGraph.fromArrows(treeArrows);\n      if (!(newGraph.isMultiTree || newGraph.isTree)) {\n        treeArrows.pop();\n        restArrows.push(arrow);\n      } else {\n        graph = newGraph;\n      }\n    }\n    return [graph, restArrows];\n  }\n\n  static fromArrows(arrows: Array<Arrow>): DirectedGraph {\n    const nameToVertex: Record<string, Vertex> = {};\n    let id = -1;\n    for (const arrow of arrows) {\n      const predecessorName = arrow.start;\n      const successorName = arrow.end;\n      let predecessorId = nameToVertex[predecessorName]?.id;\n      let successorId = nameToVertex[successorName]?.id;\n\n      if (predecessorId === undefined) {\n        predecessorId = ++id;\n        nameToVertex[predecessorName] = new Vertex(\n          predecessorId,\n          predecessorName\n        );\n      }\n      if (successorId === undefined) {\n        successorId = ++id;\n        nameToVertex[successorName] = new Vertex(successorId, successorName);\n      }\n      const successor = nameToVertex[successorName];\n      const predecessor = nameToVertex[predecessorName];\n      successor.predecessors.push(predecessor);\n      predecessor.successors.push(successor);\n    }\n    return new DirectedGraph(Object.values(nameToVertex));\n  }\n}\n\nexport class Tree {\n  constructor(public vertices: Array<Vertex>) {}\n\n  static fromRoot(root: Vertex): Tree {\n    return new Tree([root].concat(root.descendants));\n  }\n\n  get root(): Vertex {\n    return this.vertices.filter((v) => v.predecessors.length === 0)[0];\n  }\n\n  get data(): Array<{ id: number; name: string; predecessors?: number }> {\n    return this.vertices\n      .filter((v) => v.isDescendant(this.root))\n      .map((v: Vertex) => ({\n        id: v.id,\n        name: v.name,\n        parent: v.predecessors[0]?.id,\n      }));\n  }\n\n  get depth(): number {\n    const cache = {};\n    return apply(\n      Math.max,\n      this.vertices.map((v) => v.depth(cache))\n    );\n  }\n\n  get breadth(): number {\n    return this.vertices.filter((v) => v.successors.length === 0).length;\n  }\n}\n\nexport function parse(graph: string): [DirectedGraph, Record<string, ArrowWithPosition[]>] {\n  const arrowToPos: Record<string, ArrowWithPosition[]> = groupByArrow(tokenize(graph));\n  const arrows = Object.values(arrowToPos).map((p) => p[0].arrow);\n  return [DirectedGraph.fromArrows(arrows), arrowToPos];\n}\n","import React, { useState, useEffect, useRef, useLayoutEffect } from \"react\";\nimport { makeStyles, createStyles, Theme } from \"@material-ui/core/styles\";\nimport Typography from \"@material-ui/core/Typography\";\nimport {\n  Grid,\n  Paper,\n  AppBar,\n  Toolbar,\n  Button,\n  IconButton,\n} from \"@material-ui/core\";\nimport SaveOutlinedIcon from \"@material-ui/icons/SaveOutlined\";\nimport GitHubIcon from \"@material-ui/icons/GitHub\";\nimport FullscreenIcon from \"@material-ui/icons/Fullscreen\";\nimport FullscreenExitIcon from \"@material-ui/icons/FullscreenExit\";\nimport { Vega } from \"react-vega\";\nimport {\n  ControlledEditor as Editor,\n  monaco,\n  EditorDidMount,\n} from \"@monaco-editor/react\";\nimport firebase from \"firebase/app\";\nimport {\n  HashRouter as Router,\n  Switch,\n  Route,\n  Redirect,\n} from \"react-router-dom\";\nimport \"firebase/firestore\";\nimport treeSpec from \"./TreeSpec\";\nimport { parse, DirectedGraph, Tree } from \"./parser\";\nimport { flatten } from \"ramda\";\n\nconst useStyles = makeStyles((theme: Theme) => {\n  return createStyles({\n    root: {\n      height: \"calc(100vh - 10px)\",\n      display: \"flex\",\n      flexDirection: \"column\",\n    },\n    appBar: {\n      backgroundColor: \"#fff\",\n      color: \"#000\",\n    },\n    saveButton: {\n      marginLeft: theme.spacing(6),\n    },\n    toolbarRightDiv: {\n      marginLeft: \"auto\",\n    },\n    toggleButton: {\n      position: \"absolute\",\n      top: \"2px\",\n      right: \"2px\",\n    },\n    main: {\n      flexGrow: 1,\n      flexDirection: \"row-reverse\",\n      overflow: \"auto\",\n      padding: theme.spacing(1),\n    },\n    pane: {\n      height: \"100%\",\n    },\n    paper: {\n      color: theme.palette.text.secondary,\n      height: \"100%\",\n      overflow: \"auto\",\n    },\n    center: {\n      width: \"50%\",\n      margin: \"auto\",\n    },\n  });\n});\n\n// Initialize Firebase\nfirebase.initializeApp({\n  apiKey: \"AIzaSyAcRmmHUN_Yyqd0al0MSvRz82kIbrHvh-8\",\n  authDomain: \"hierarchy-28591.firebaseapp.com\",\n  databaseURL: \"https://hierarchy-28591.firebaseio.com\",\n  projectId: \"hierarchy-28591\",\n  storageBucket: \"hierarchy-28591.appspot.com\",\n  messagingSenderId: \"761635818549\",\n  appId: \"1:761635818549:web:b6d6fecfd7747c6345f57c\",\n  measurementId: \"G-TJJF0BJ57G\",\n});\nconst firestore = firebase.firestore();\n\nexport default function App() {\n  return (\n    <Router>\n      <Switch>\n        <Route\n          path=\"/:docId\"\n          render={({ match }) => <GraphContainer docId={match.params.docId} />}\n        />\n        <Route path=\"/\" render={() => <GraphContainer docId=\"default\" />} />\n      </Switch>\n    </Router>\n  );\n}\n\ntype GraphContainerProps = {\n  docId: string;\n};\n\nfunction makeid(length: number): string {\n  var result = \"\";\n  var characters =\n    \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n  var charactersLength = characters.length;\n  for (var i = 0; i < length; i++) {\n    result += characters.charAt(Math.floor(Math.random() * charactersLength));\n  }\n  return result;\n}\n\nfunction GraphContainer({ docId }: GraphContainerProps) {\n  const [data, setData] = useState(\"\");\n  const [redirect, setRedirect] = useState<string | null>(null);\n\n  useEffect(() => {\n    const fetchDoc = async () => {\n      const doc = await firestore.collection(\"graphs\").doc(docId).get();\n      const data = doc.data()?.graph;\n      if (!doc.exists || data === null) {\n        setRedirect(\"\");\n      } else {\n        setRedirect(null);\n        setData(data.replace(/\\\\n/gi, \"\\n\"));\n      }\n    };\n    fetchDoc();\n  }, [docId]);\n\n  if (redirect !== null) {\n    return <Redirect to={redirect} />;\n  }\n  return (\n    <Graph\n      data={data}\n      handleChange={setData}\n      handleSave={async (data) => {\n        const id = makeid(6);\n        await firestore.collection(\"graphs\").doc(id).set({ graph: data });\n        setRedirect(id);\n      }}\n    />\n  );\n}\n\ntype GraphProps = {\n  data: string;\n  handleChange(data: string): void;\n  handleSave(data: string): void;\n};\n\nfunction MultiTree({ multiTree }: { multiTree: DirectedGraph }) {\n  return (\n    <>\n      {multiTree.roots.map((root, index) => {\n        const tree = Tree.fromRoot(root);\n        const depth = tree.depth;\n        const width = depth === Infinity ? 600 : 120 * depth;\n        const breadth = tree.breadth;\n        const space = 30 * Math.E ** (-breadth / 40) + 7;\n        const height = breadth * space;\n        return (\n          <Vega\n            key={index}\n            spec={{ ...treeSpec, width, height }}\n            data={{ tree: tree.data }}\n          />\n        );\n      })}\n    </>\n  );\n}\n\ninterface RefObject {\n  getModel: () => void;\n}\n\nfunction Graph({ data, handleChange, handleSave }: GraphProps) {\n  const editorRef = useRef<RefObject | null>(null);\n  const classes = useStyles();\n  const [isEditorReady, setIsEditorReady] = useState(false);\n  const [isOnePane, setIsOnePane] = useState(false);\n  const [directedGraph, pairToPositions] = parse(data);\n  const [tree, rest] = directedGraph.findTree();\n  const errors = flatten(\n    rest.map((arrow) => pairToPositions[arrow.toString()])\n  ).map(({ startRow, startCol, endRow, endCol }) => ({\n    startLineNumber: startRow,\n    startColumn: startCol,\n    endLineNumber: endRow,\n    endColumn: endCol,\n    message: \"This arrow is discarded as it makes the tree invalid.\",\n  }));\n\n  useLayoutEffect(() => {\n    monaco.init().then((monacoInstance) => {\n      if (isEditorReady && editorRef.current !== null) {\n        monacoInstance.editor.setModelMarkers(\n          editorRef.current.getModel(),\n          \"owner\",\n          errors.map((error) => ({\n            ...error,\n            severity: monacoInstance.MarkerSeverity.Error,\n          }))\n        );\n      }\n    });\n  });\n\n  const handleEditorDidMount: EditorDidMount = (_, editor) => {\n    setIsEditorReady(true);\n    editorRef.current = editor;\n  };\n\n  return (\n    <div className={classes.root}>\n      <AppBar position=\"static\" className={classes.appBar} elevation={1}>\n        <Toolbar>\n          <Typography variant=\"h6\">Visualize Hierarchical Data</Typography>\n          <Button className={classes.saveButton}>\n            <SaveOutlinedIcon />\n            save\n          </Button>\n          <div className={classes.toolbarRightDiv}>\n            <IconButton\n              href=\"https://github.com/cliffxuan/viz\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              <GitHubIcon />\n            </IconButton>\n          </div>\n        </Toolbar>\n      </AppBar>\n      <Grid container spacing={1} className={classes.main}>\n        <Grid\n          item\n          xs={12}\n          md={isOnePane ? 12 : 8}\n          className={classes.pane}\n          style={{ position: \"relative\" }}\n        >\n          <Paper variant=\"outlined\" className={classes.paper} square>\n            <div className={isOnePane ? classes.center : \"\"}>\n              <MultiTree multiTree={tree} />\n            </div>\n          </Paper>\n          <IconButton\n            className={classes.toggleButton}\n            size=\"small\"\n            onClick={() => setIsOnePane(!isOnePane)}\n          >\n            {isOnePane ? <FullscreenExitIcon /> : <FullscreenIcon />}\n          </IconButton>\n        </Grid>\n        {isOnePane ? null : (\n          <Grid item xs={12} md={4} className={classes.pane}>\n            <Paper variant=\"outlined\" className={classes.paper} square>\n              <Editor\n                language=\"plain_text\"\n                value={data}\n                width=\"100%\"\n                editorDidMount={handleEditorDidMount}\n                onChange={(_, value) =>\n                  value === undefined ? value : handleChange(value)\n                }\n                options={{\n                  minimap: { enabled: false },\n                  scrollBeyondLastLine: false,\n                }}\n              />\n            </Paper>\n          </Grid>\n        )}\n      </Grid>\n    </div>\n  );\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App/>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}